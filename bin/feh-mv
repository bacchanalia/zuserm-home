#!/usr/bin/perl
use strict;
use warnings;

sub notify($);
sub run(@);

sub main(@){
  die "Usage: $0 FILE [DIR_SUFFIX]\n" if @_ != 2;
  my ($file, $dirSuffix) = @_;
  die "file \"$file\" not found\n" if not -f $file;
  die "invalid $dirSuffix, word characters only\n" if $dirSuffix !~ /^\w*$/;

  my $dir = "fehdir$dirSuffix";
  run "mkdir", "-p", $dir;
  die "file \"$dir/$file\" already exists\n" if -e "$dir/$file";
  run "mv", "--no-clobber", $file, $dir;
  notify "moved to $dir: $file";
}

sub notify($){
  my $msg = shift;
  chomp $msg;
  run "notify-send", "-t", 2000, $msg;
}

sub run(@){
  print "@_\n";
  system @_;
  die "Error running \"@_\"\n" if $? != 0;
}

&main(@ARGV);
