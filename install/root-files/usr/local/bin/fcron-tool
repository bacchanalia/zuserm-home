#!/usr/bin/perl
use strict;
use warnings;

my $tab = "/etc/fcrontab";
my $spool = "/usr/local/var/spool/fcron";

sub fcronReset();
sub run(@);

sub main(@){
  fcronReset();
}

sub fcronReset(){
  print "killing fcron and removing spooled tabs\n";
  run "sudo", "pkill", "-9", "fcron";
  run "sudo rm -r $spool/*";

  print "restarting fcron";
  run "sudo", "fcron-start";

  print "removing fcrontab\n";
  run "sudo", "fcrontab", "-r";
  print "loading fcrontab $tab\n";
  run "sudo", "fcrontab", $tab;
}

sub run(@){
  print "@_\n";
  system @_;
}

&main(@ARGV);
